<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>9 Eyes FPS</title>
<style>
body { margin:0; overflow:hidden; font-family:Arial; }
#menu {
position:absolute;
width:100%;
height:100%;
background:black;
color:white;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
z-index:10;
}
#hud {
position:absolute;
top:20px;
left:20px;
color:white;
z-index:5;
text-shadow:0 0 5px black;
}
button {
padding:15px 30px;
font-size:20px;
cursor:pointer;
}
</style>
</head>
<body>

<div id="menu">
<h1>9 EYES FPS</h1>
<button onclick="startGame()">JOUER</button>
</div>

<div id="hud" style="display:none;">
‚ù§Ô∏è Vie: <span id="hp">100</span><br>
üî´ Balles: <span id="ammo">30</span>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>

<script>
let scene, camera, renderer;
let enemies = [];
let health = 100;
let ammo = 30;
let controlsEnabled = false;

let moveForward=false, moveBackward=false, moveLeft=false, moveRight=false;
let velocity = new THREE.Vector3();
let direction = new THREE.Vector3();

let pitch = 0;
let yaw = 0;

function startGame(){
document.getElementById("menu").style.display="none";
document.getElementById("hud").style.display="block";
init();
animate();
}

function init(){

scene = new THREE.Scene();
scene.background = new THREE.Color(0x87CEEB);

camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
camera.position.y = 2;

renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(10,20,10);
scene.add(light);
scene.add(new THREE.AmbientLight(0xffffff,0.5));

const floor = new THREE.Mesh(
new THREE.PlaneGeometry(1000,1000),
new THREE.MeshStandardMaterial({color:0x228B22})
);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// arme
const gun = new THREE.Mesh(
new THREE.BoxGeometry(0.5,0.3,1),
new THREE.MeshStandardMaterial({color:0x333333})
);
gun.position.set(0.6,-0.5,-1);
camera.add(gun);
scene.add(camera);

// ennemis
for(let i=0;i<5;i++) spawnEnemy();

// souris
document.body.addEventListener("click", ()=>{
document.body.requestPointerLock();
});

document.addEventListener("mousemove", (e)=>{
if(document.pointerLockElement === document.body){
yaw -= e.movementX * 0.002;
pitch -= e.movementY * 0.002;
pitch = Math.max(-Math.PI/2, Math.min(Math.PI/2, pitch));
camera.rotation.set(pitch, yaw, 0);
}
});

// clavier
document.addEventListener("keydown", (e)=>{
if(e.key=="z") moveForward=true;
if(e.key=="s") moveBackward=true;
if(e.key=="q") moveLeft=true;
if(e.key=="d") moveRight=true;

if(e.key=="r"){
ammo = 30;
document.getElementById("ammo").innerText=ammo;
}
});

document.addEventListener("keyup", (e)=>{
if(e.key=="z") moveForward=false;
if(e.key=="s") moveBackward=false;
if(e.key=="q") moveLeft=false;
if(e.key=="d") moveRight=false;
});

// tir
document.addEventListener("mousedown", shoot);
}

function spawnEnemy(){
let group = new THREE.Group();

let body = new THREE.Mesh(
new THREE.BoxGeometry(2,4,1),
new THREE.MeshStandardMaterial({color:0x111111})
);
group.add(body);

// 9 yeux
for(let i=0;i<9;i++){
let eye = new THREE.Mesh(
new THREE.SphereGeometry(0.2),
new THREE.MeshStandardMaterial({color:0xff0000, emissive:0xff0000})
);
eye.position.set((i%3)-1, Math.floor(i/3)-1, 0.6);
group.add(eye);
}

group.position.set(Math.random()*200-100,2,Math.random()*200-100);
scene.add(group);
enemies.push(group);
}

function shoot(){
if(ammo<=0) return;
ammo--;
document.getElementById("ammo").innerText=ammo;

let raycaster = new THREE.Raycaster();
raycaster.setFromCamera(new THREE.Vector2(0,0), camera);
let intersects = raycaster.intersectObjects(enemies,true);

if(intersects.length>0){
let enemy = intersects[0].object.parent;
scene.remove(enemy);
enemies.splice(enemies.indexOf(enemy),1);
spawnEnemy();
}
}

function animate(){
requestAnimationFrame(animate);

velocity.x = 0;
velocity.z = 0;

if(moveForward) velocity.z -= 0.5;
if(moveBackward) velocity.z += 0.5;
if(moveLeft) velocity.x -= 0.5;
if(moveRight) velocity.x += 0.5;

camera.translateX(velocity.x);
camera.translateZ(velocity.z);

enemies.forEach(enemy=>{
enemy.lookAt(camera.position);
enemy.position.x += (camera.position.x - enemy.position.x)*0.002;
enemy.position.z += (camera.position.z - enemy.position.z)*0.002;

if(enemy.position.distanceTo(camera.position)<2){
health -= 0.2;
document.getElementById("hp").innerText=Math.floor(health);
}
});

renderer.render(scene,camera);
}
</script>

</body>
</html>
